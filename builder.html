<!DOCTYPE html>
<html lang="en">
<head>
    <title>Recursive Pixlpals</title>
    <link rel="stylesheet" href="https://unpkg.com/98.css">
    <link rel="stylesheet" href="styles.css">
    </head>
    <script src="https://cdn.jsdelivr.net/gh/cferdinandi/tabby@12.0.0/dist/js/tabby.polyfills.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/cferdinandi/tabby@12.0.0/dist/js/tabby.min.js"></script>
<body>
    <div id="toolbar" class="toolbar">
        <div class="toolbar-start-menu">
          <button class="start-button">
            Start
          </button>
          
          <div class="start-menu-wrapper">
            <div class="start-menu-title">
            
            </div>
            
            <div class="start-menu">
            </div>
          </div>
        </div>
        <div class="toolbar-separator"></div>
     
        <div class="toolbar-right">
          <div class="time"><span class="hour"></span>4:20<span class="minutes"></span> PM</div>
        </div>
    </div>
    <div class="desktop-icons">
        <div class="desktop-icon my-computer" title="My Computer">
            <img src="https://imagizer.imageshack.com/img922/9062/jpod6a.png" alt="Computer Icon">
            <span>My Computer</span>
        </div>
        <div class="desktop-icon my-documents" title="My Documents">
            <img src="https://imagizer.imageshack.com/img923/8678/qkFsVh.png" alt="Documents">
            <span>My Documents</span>
        </div>
        <div class="desktop-icon network" title="Network Neighborhood">
            <img src="https://imagizer.imageshack.com/img922/697/ubSnAD.png" alt="Network">
            <span>Pixlbuilder</span>
        </div>
        <div class="desktop-icon trash-empty" title="Recycle Bin">
            <img src="https://imagizer.imageshack.com/img924/1802/wSeUA2.png" alt="Recycle">
            <span>Recycle Bin</span>
        </div>
    </div>        
    <form id="punk-form">
        <div class="window" style="width: 500px;">

            <div class="title-bar">
                <div class="title-bar-text">Pixlbuilder</div>
            </div>

            <div id="image-preview-wrapper">
                <div id="image-preview">
                    <img id="background-image" src="https://imagizer.imageshack.com/img923/8831/qboiiP.png">
                    <img id="style-image">
                    <img id="body-image">
                    <img id="head-image">
                    <img id="eyes-image">
                    <button id="compile-button">Compile</button>
                </div>

            <div class="window-body">
                <div id="initial-text">
                    <p><br><br>Welcome to the pixlbuilder.<br><br><br>Below you can select different traits and build a Pixlpal that best represents yourself. This is just a fun experiment however it does requires you to inscribe the SVG file that is compiled for you. The inscription fee should only cost a few dollars.<br><br><br><br></p>
                    <menu class="menu" role="tablist" data-tabs>
                    <li role="tab" aria-selected="true"><a href="#backgrounds">Background</a></li>
                    <li role="tab"><a href="#styles">Type</a></li>
                    <li role="tab"><a href="#body">Clothing</a></li>
                    <li role="tab"><a href="#head">Head</a></li>
                    <li role="tab"><a href="#eyes">Eyes</a></li>
                </menu>
            </div>
                       
                <div class="window" role="tabpanel">
                    <div class="window-body">
              <!-- Your tab content goes here -->
              <div class="tab-content">
                  <div id="backgrounds">
                      <div class="form-group">
                          <div class="category-grid" id="backgrounds-grid"></div>
                      </div>                
                  </div>

                  <div id="styles">
                      <div class="form-group">
                          <div class="category-grid" id="styles-grid"></div>
                      </div>
                  </div>

                  <div id="body">
                      <div class="form-group">
                          <div class="category-grid" id="body-grid"></div>
                      </div>
                  </div>

                  <div id="head">
                      <div class="form-group">
                          <div class="category-grid" id="head-grid"></div>
                      </div>
                  </div>

                  <div id="eyes">
                      <div class="form-group">
                          <div class="category-grid" id="eyes-grid"></div>
                      </div>
                  </div>

                </div>          
              </div>
            </div>
          </div>          
    </form>
</form>
    <script>

        var backgrounds = [
            { name: 'None', image: 'https://imagizer.imageshack.com/img923/8831/qboiiP.png' },
            { name: 'Orange', image: 'https://imagizer.imageshack.com/img923/3342/Ef1fo2.png' },
            { name: 'Blue', image: 'https://imagizer.imageshack.com/img924/6237/cFZTzY.png' }
        ];

        function updateBackgrounds() {
    var backgroundsDiv = document.getElementById('backgrounds-grid');
    backgroundsDiv.innerHTML = '';

    if (!document.getElementById('backgrounds-text')) {
        var textDiv = document.createElement('div');
        textDiv.style.textAlign = 'center';
        var textElement = document.createElement('p');
        textElement.textContent = "Choose a background...";
        textElement.className = 'instruction-text';
        textElement.id = 'backgrounds-text';
        textDiv.appendChild(textElement);

        backgroundsDiv.parentNode.insertBefore(textDiv, backgroundsDiv);
    }

    for (var i = 0; i < backgrounds.length; i++) {
        var div = document.createElement('div');
        div.className = 'category-option';

        var img = document.createElement('img');
        img.src = backgrounds[i].image;

        img.addEventListener('click', function() {
            var compilerImage = document.getElementById('background-image');
            compilerImage.src = this.src;
        });

        div.appendChild(img);
        backgroundsDiv.appendChild(div);
    }
}
    
        var styles = [
    { name: 'Ape', image: 'https://imagizer.imageshack.com/img922/8204/Ajz91a.png' },
    { name: 'Ape', image: 'https://imagizer.imageshack.com/img923/2849/7LxZHB.png' },
    { name: 'Ape', image: 'https://imagizer.imageshack.com/img924/5544/bkJ6V3.png' },
    { name: 'Ape', image: 'https://imagizer.imageshack.com/img923/1212/mA37no.png' },
    { name: 'Ape', image: 'https://imagizer.imageshack.com/img924/8415/fFmy0H.png' },
    { name: 'Ape', image: 'https://imagizer.imageshack.com/img922/4281/3ZLeSa.png' },
    { name: 'Zombie', image: 'https://imagizer.imageshack.com/img923/1760/pb6Mf0.png' }
];

function updateStyles() {
    var stylesDiv = document.getElementById('styles-grid');
    stylesDiv.innerHTML = '';

    if (!document.getElementById('styles-text')) {
        var textDiv = document.createElement('div');
        textDiv.style.textAlign = 'center';
        var textElement = document.createElement('p');
        textElement.textContent = "Select your body type...";
        textElement.className = 'instruction-text';
        textElement.id = 'styles-text';
        textDiv.appendChild(textElement);

        stylesDiv.parentNode.insertBefore(textDiv, stylesDiv);
    }

    for (var i = 0; i < styles.length; i++) {
        var div = document.createElement('div');
        div.className = 'category-option';

        var img = document.createElement('img');
        img.src = styles[i].image;

        img.addEventListener('click', function() {
            var compilerImage = document.getElementById('style-image');
            compilerImage.src = this.src;
        });

        div.appendChild(img);
        stylesDiv.appendChild(div);
    }
}

var body = [
    { name: '1', image: 'https://imagizer.imageshack.com/img923/8995/SieDSD.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img922/9277/YGZz1F.png' },
    { name: '3', image: 'https://imagizer.imageshack.com/img922/4393/nsKNPZ.png' },
    { name: '4', image: 'https://imagizer.imageshack.com/img924/3497/vj8KzB.png' },
    { name: '5', image: 'https://imagizer.imageshack.com/img923/3251/f8nDYN.png' }
];

function updateBody() {
    var bodyDiv = document.getElementById('body-grid');
    bodyDiv.innerHTML = '';

    if (!document.getElementById('body-text')) {
        var textDiv = document.createElement('div');
        textDiv.style.textAlign = 'center';
        var textElement = document.createElement('p');
        textElement.textContent = "Pick some apparel...";
        textElement.className = 'instruction-text';
        textElement.id = 'body-text';
        textDiv.appendChild(textElement);

        bodyDiv.parentNode.insertBefore(textDiv, bodyDiv);
    }

    for (var i = 0; i < body.length; i++) {
        var div = document.createElement('div');
        div.className = 'category-option';

        var img = document.createElement('img');
        img.src = body[i].image;

        img.addEventListener('click', function() {
            var compilerImage = document.getElementById('body-image');
            compilerImage.src = this.src;
        });

        div.appendChild(img);
        bodyDiv.appendChild(div);
    }
}

var head = [
    { name: '1', image: 'https://imagizer.imageshack.com/img922/1029/zk8LLV.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img924/2660/NZm0kX.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img923/3924/r4j9c3.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img922/4083/FNsNyH.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img923/4224/HQKpIG.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img922/5818/eaXh69.png' },
    { name: '3', image: 'https://imagizer.imageshack.com/img922/2888/k027Y3.png' }
];

function updateHead() {
    var headDiv = document.getElementById('head-grid');
    headDiv.innerHTML = '';

    if (!document.getElementById('head-text')) {
        var textDiv = document.createElement('div');
        textDiv.style.textAlign = 'center';
        var textElement = document.createElement('p');
        textElement.textContent = "Select some headwear...";
        textElement.className = 'instruction-text';
        textElement.id = 'head-text';
        textDiv.appendChild(textElement);

        headDiv.parentNode.insertBefore(textDiv, headDiv);
    }

    for (var i = 0; i < head.length; i++) {
        var div = document.createElement('div');
        div.className = 'category-option';

        var img = document.createElement('img');
        img.src = head[i].image;

        img.addEventListener('click', function() {
            var compilerImage = document.getElementById('head-image');
            compilerImage.src = this.src;
        });

        div.appendChild(img);
        headDiv.appendChild(div);
    }
}

var eyes = [
    { name: '1', image: 'https://imagizer.imageshack.com/img923/5646/KP0BMg.png' },
    { name: '2', image: 'https://imagizer.imageshack.com/img923/2424/zKRU7o.png' },
    { name: '3', image: 'https://imagizer.imageshack.com/img922/2806/DRYdmQ.png' },
    { name: '4', image: 'https://imagizer.imageshack.com/img924/8213/84jZRc.png' },
    { name: '5', image: 'https://imagizer.imageshack.com/img923/6562/3e3IrY.png' },
    { name: '6', image: 'https://imagizer.imageshack.com/img924/102/XqT38a.png' }
];

function updateEyes() {
    var eyesDiv = document.getElementById('eyes-grid');
    eyesDiv.innerHTML = '';

    if (!document.getElementById('eyes-text')) {
        var textDiv = document.createElement('div');
        textDiv.style.textAlign = 'center';
        var textElement = document.createElement('p');
        textElement.textContent = "Add some eyewear...";
        textElement.className = 'instruction-text';
        textElement.id = 'eyes-text';
        textDiv.appendChild(textElement);

        eyesDiv.parentNode.insertBefore(textDiv, eyesDiv);
    }

    for (var i = 0; i < eyes.length; i++) {
        var div = document.createElement('div');
        div.className = 'category-option';

        var img = document.createElement('img');
        img.src = eyes[i].image;

        // Add event listener to the image
        img.addEventListener('click', function() {
            // Get the compiler image element
            var compilerImage = document.getElementById('eyes-image');

            // Set the source of the compiler image to the source of the clicked image
            compilerImage.src = this.src;
        });

        div.appendChild(img);
        eyesDiv.appendChild(div);
    }
}


function showIframeWindow() {
  // Check if the iframe window is already open
  var existingIframe = document.getElementById('iframe-window');
  if (existingIframe) {
    existingIframe.style.display = 'block'; // Show the existing iframe window
    return; // Exit the function to prevent opening multiple iframes
}

// Create the iframe window element
var windowElement = document.createElement('div');
windowElement.className = 'window';
windowElement.id = 'iframe-window';
windowElement.style.width = '825px';
windowElement.style.height = '700px';
windowElement.style.position = 'fixed';
windowElement.style.top = '50%';
windowElement.style.left = '50%';
windowElement.style.transform = 'translate(-50%, -50%)';
windowElement.style.zIndex = '1000';

  // Create the title bar
  var titleBar = document.createElement('div');
  titleBar.className = 'title-bar';

  var titleBarText = document.createElement('div');
  titleBarText.className = 'title-bar-text';
  titleBarText.textContent = 'Inscribe Your Pixlpal';

  var closeButton = document.createElement('button');
  closeButton.textContent = 'X';
  closeButton.className = 'close-button';

  // Append the elements to the title bar
  titleBar.appendChild(titleBarText);
  titleBar.appendChild(closeButton);
  windowElement.appendChild(titleBar);

closeButton.addEventListener('click', function() {
    windowElement.style.display = 'none'; // Hide the iframe window when the close button is clicked
  });

// Open the iframe window when the compile button is clicked
document.getElementById('compile-button').addEventListener('click', function(event) {
    event.preventDefault(); // Prevent default form submission behavior
    compileSVG();
});

    windowElement.appendChild(titleBar);

    // Create the window body
    var windowBody = document.createElement('div');
    windowBody.className = 'window-body';

    // Create the iframe
    var iframe = document.createElement('iframe');
    iframe.style.width = '800px'; // Make the iframe width 100% of the window
    iframe.style.height = '640px'; // Make the iframe height 100% of the window
    iframe.style.position = 'fixed';
    iframe.style.border = 'none'; // Remove the iframe border
    iframe.src = 'https://unisat.io/inscribe';

    windowBody.appendChild(iframe);
    windowElement.appendChild(windowBody);

    // Append the window element to the document body
    document.body.appendChild(windowElement);
}

// Event listener for the form submission
document.getElementById('punk-form').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent the default form submission behavior
    showIframeWindow(); // Show the iframe window
});

// Open the iframe window when the compile button is clicked
document.getElementById('compile-button').addEventListener('click', function() {
});


function compileSVG() {
  // Confirmation dialog
  if (!confirm("Are you sure you want to compile and download the SVG?")) {
    return; // Exit the function if the user cancels the confirmation
  }

  // Get the selected traits
  var backgroundImage = document.getElementById('background-image').src.split('/').pop();
  var styleImage = document.getElementById('style-image').src.split('/').pop();
  var bodyImage = document.getElementById('body-image').src.split('/').pop();
  var headImage = document.getElementById('head-image').src.split('/').pop();
  var eyesImage = document.getElementById('eyes-image').src.split('/').pop();

  // Create the SVG string
  var svgString = '<svg width="24px" height="24px" xmlns="http://www.w3.org/2000/svg">\n';
  svgString += '<image href="' + backgroundImage + '" />\n';
  svgString += '<image href="' + styleImage + '" />\n';
  svgString += '<image href="' + bodyImage + '" />\n';
  svgString += '<image href="' + headImage + '" />\n';
  svgString += '<image href="' + eyesImage + '" />\n';
  svgString += '</svg>';

  // Download the SVG string as a file
  var element = document.createElement('a');
  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(svgString));
  element.setAttribute('download', 'output.svg');

  element.style.display = 'none';
  document.body.appendChild(element);

  element.click();

  document.body.removeChild(element);
}


    
window.addEventListener('DOMContentLoaded', function() {
    updateBackgrounds();
    updateStyles();
    updateBody();
    updateHead();

    // Hide all tab content
    var tabContents = document.querySelectorAll('.tab-content > div');
    tabContents.forEach(function(tabContent) {
        tabContent.style.display = 'none';
    });

    // Show content for the first tab
    document.querySelector('.tab-content > div').style.display = 'block';

    // Remove focus from all tabs
    var tabLinks = document.querySelectorAll('.menu a');
    tabLinks.forEach(function(tabLink) {
        tabLink.blur();
    });

    document.getElementById('compile-button').addEventListener('click', compileSVG);

    // Add event listener to the form submission
    document.getElementById('punk-form').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission behavior
    });
});
    
var tabs = new Tabby('[data-tabs]');

// Add event listener for tab switching
 var tabLinks = document.querySelectorAll('.menu a');
    tabLinks.forEach(function(tabLink) {
        tabLink.addEventListener('click', function(event) {
            // Prevent the default action
            event.preventDefault();

            // Remove active class from all tabs
            tabLinks.forEach(function(tabLink) {
                tabLink.classList.remove('active');
                tabLink.parentNode.setAttribute('aria-selected', 'false');
            });

            // Add active class to clicked tab
            this.classList.add('active');
            this.parentNode.setAttribute('aria-selected', 'true');

            // Hide all tab content
            var tabContents = document.querySelectorAll('.tab-content > div');
            tabContents.forEach(function(tabContent) {
                tabContent.style.display = 'none';
            });

            // Show content for clicked tab
            var tabContent = document.querySelector(this.getAttribute('href'));
            tabContent.style.display = 'block';

            // If the "Backgrounds" tab is clicked, update the backgrounds
            if (this.getAttribute('href') === '#backgrounds') {
                updateBackgrounds();
            }

            // If the "Styles" tab is clicked, update the styles
            if (this.getAttribute('href') === '#styles') {
                updateStyles();
            }

            // If the "Body" tab is clicked, update the body images
            if (this.getAttribute('href') === '#body') {
                updateBody();
            }

            // If the "Head" tab is clicked, update the head images
            if (this.getAttribute('href') === '#head') {
                updateHead();
            }

            // If the "Eyes" tab is clicked, update the eyes images
            if (this.getAttribute('href') === '#eyes') {
                updateEyes();
            }
 
        });
    });
    </script>
    </body>
    </html>
